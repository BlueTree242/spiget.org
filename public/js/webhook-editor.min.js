window.webhook={loadEvents:function(){$.ajax({url:"https://api.spiget.org/v2/webhook/events?spiget___ua=SpigetWebhooks&callback=?",dataType:"jsonp",success:function(b){$.each(b.events,function(a,d){$("#events_group").append("<input type='checkbox' class='webhook-event' value='"+d+"'> "+d+"<br/>")})}})},ignoreConnection:!1,testConnection:function(b,a,d){webhook.ignoreConnection?d(!0):($("#registerButton").prop("disabled",!0),Alert.alert("info","Testing connection...",!0),$.ajax({url:"https://tools.inventivetalent.org/connection/ping.php?spiget___ua=SpigetWebhooks&callback=?&method=POST&url="+
btoa(b),dataType:"jsonp",success:function(a){a.success?($("#registerButton").prop("disabled",!1),Alert.alert("success","Connection was successful",!0),d(!0)):(Alert.alert("danger","",!0),$("#footer_alert_value").append("Connection failed. Status code: "+err.code+" | If you are sure it will work anyway, <a href='#' id='ignoreConnection'>click here</a>"),d(!1))},error:function(a,b,f){a=eval("("+a.responseText+")");void 0===a&&(a={code:-1});Alert.alert("danger","",!0);$("#footer_alert_value").append("Connection failed. Status code: "+
a.code+" | If you are sure it will work anyway, <a href='#' id='ignoreConnection'>click here</a>");d(!1)}}))},register:function(b,a){$("#registerButton").prop("disabled",!0);$("#webhookId").val("");$("#webhookSecret").val("");$.ajax({url:"https://api.spiget.org/v2/webhook/register?spiget___ua=SpigetWebhooks&",method:"POST",type:"POST",data:{url:b,events:JSON.stringify(a)},success:function(a){$("#webhookId").val(a.id);$("#webhookSecret").val(a.secret);Alert.alert("success","Webhook created. Make sure to save the ID & Secret!",
!0);$("#registerButton").prop("disabled",!1)},error:function(a,b,e){a=eval("("+a.responseText+")");Alert.alert("danger","Error: "+a.error,!0);$("#registerButton").prop("disabled",!1)}})},remove:function(b,a){$("#removeButton").prop("disabled",!0);$.ajax({url:"https://api.spiget.org/v2/webhook/delete/"+b+"/"+a+"?spiget___ua=SpigetWebhooks&",method:"POST",type:"POST",success:function(a){Alert.alert("success","Webhook removed",!0);$("#removeButton").prop("disabled",!1)},error:function(a,b,e){a=eval("("+
a.responseText+")");void 0===a&&(a={code:-1});Alert.alert("danger","Error: "+a.error,!0);$("#removeButton").prop("disabled",!1)}})}};
$(document).ready(function(){webhook.loadEvents();var b=function(){var a=!1,a=0==$("#targetUrl").val().trim().length?!0:!1;a||(c=0,$("input.webhook-event:checked").each(function(){c++}),console.log(c),a=0<c?!1:!0);$("#registerButton").prop("disabled",a)};$("#targetUrl").on("keyup change",b);$(document).on("change","input.webhook-event",b);b=function(){0==$("#delete-id").val().trim().length||0==$("#delete-secret").val().trim().length?$("#deleteButton").prop("disabled",!0):$("#deleteButton").prop("disabled",
!1)};$("#delete-id").on("keyup change",b);$("#delete-secret").on("keyup change",b);$("#registerButton").click(function(a){a.preventDefault();$url=$("#targetUrl").val();$events=[];$("input.webhook-event:checked").each(function(){$events.push($(this).val())});webhook.testConnection($url,$events[0],function(a){a&&setTimeout(function(){webhook.register($url,$events)},200)})});$("#deleteButton").click(function(a){a.preventDefault();$id=$("#delete-id");$secret=$("#delete-secret");webhook.remove($id.val().trim(),
$secret.val().trim())});$(document).on("click","#ignoreConnection",function(a){a.preventDefault();webhook.ignoreConnection=!0;$("#registerButton").prop("disabled",!1)})});
